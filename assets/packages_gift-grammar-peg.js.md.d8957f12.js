import{_ as e,o as s,c as a,V as t}from"./chunks/framework.c495fe11.js";const g=JSON.parse('{"title":"GIFT-grammar-PEG.js","description":"","frontmatter":{},"headers":[],"relativePath":"packages/gift-grammar-peg.js.md","filePath":"packages/gift-grammar-peg.js.md"}'),o={name:"packages/gift-grammar-peg.js.md"},n=t(`<h1 id="gift-grammar-peg-js" tabindex="-1">GIFT-grammar-PEG.js <a class="header-anchor" href="#gift-grammar-peg-js" aria-label="Permalink to &quot;GIFT-grammar-PEG.js&quot;">​</a></h1><img src="https://www.etsmtl.ca/getmedia/36ccff85-3834-443c-b78f-992c2b998915/Logo_ETS_SansTypo_EN" width="100"><h3 id="status" tabindex="-1">Status <a class="header-anchor" href="#status" aria-label="Permalink to &quot;Status&quot;">​</a></h3><p><a href="https://travis-ci.org/fuhrmanator/GIFT-grammar-PEG.js" target="_blank" rel="noreferrer"><img src="https://travis-ci.org/fuhrmanator/GIFT-grammar-PEG.js.svg?branch=master" alt="Build Status"></a></p><p>Development of PEG grammar to parse <a href="https://en.wikipedia.org/wiki/GIFT_(file_format)" target="_blank" rel="noreferrer">GIFT (quiz question) file format</a>. The goal is to find an intuitive and fun way to create quiz questions.</p><p>Initial hacking done using <a href="https://pegjs.org/online" target="_blank" rel="noreferrer">pegjs.org/online</a>. The GIFT.pegjs file goes on the left and the test GIFT goes on the right. Note that nothing is saved in this environment (you must copy-paste back to your own files).</p><h2 id="gift-parser-npm-package-gift-pegjs" tabindex="-1">GIFT parser (npm package gift-pegjs) <a class="header-anchor" href="#gift-parser-npm-package-gift-pegjs" aria-label="Permalink to &quot;GIFT parser (npm package gift-pegjs)&quot;">​</a></h2><p>The PEG.js grammar in this repo is used to generate a parser for GIFT. You can see how it works in this <a href="https://fuhrmanator.github.io/GIFT-grammar-PEG.js/editor/editor.html" target="_blank" rel="noreferrer">online editor</a>.</p><h2 id="software-using-the-parser" tabindex="-1">Software using the parser <a class="header-anchor" href="#software-using-the-parser" aria-label="Permalink to &quot;Software using the parser&quot;">​</a></h2><ul><li><a href="https://github.com/ethan-ou/vscode-gift/" target="_blank" rel="noreferrer">GIFT Format Extension For Visual Studio Code</a> by Ethan Ou.</li><li>Validate GIFT questions with this <a href="https://fuhrmanator.github.io/GIFT-grammar-PEG.js/editor/editor.html" target="_blank" rel="noreferrer">online GIFT editor</a>.</li><li>Create quizzes in Google Forms using the <a href="https://gsuite.google.com/marketplace/app/gift_quiz_editor/1038395345285" target="_blank" rel="noreferrer">GIFT Quiz Editor (Google Forms add-on)</a>. It&#39;s possible to export questions from Moodle in GIFT format and re-use them in Google Forms, or you can create your own questions in GIFT to save clicking in the Google interface. Google Quizzes are not able to support all GIFT question types, however.</li></ul><h2 id="for-developers" tabindex="-1">For developers <a class="header-anchor" href="#for-developers" aria-label="Permalink to &quot;For developers&quot;">​</a></h2><h3 id="install" tabindex="-1">Install <a class="header-anchor" href="#install" aria-label="Permalink to &quot;Install&quot;">​</a></h3><p>For simple web applications, copy the <a href="https://raw.githubusercontent.com/fuhrmanator/GIFT-grammar-PEG.js/master/pegjs-gift.js" target="_blank" rel="noreferrer"><code>pegjs-gift.js</code></a> file into your project.</p><p>For modern Javascript development, install the library using npm:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm install gift-pegjs</span></span></code></pre></div><h3 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h3><p>Importing the NPM library in ES6+ Javascript (recommended):</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">parse</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">gift-pegjs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> question </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">What is the value of pi (to 3 decimal places)? {#3.141..3.142}.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> quiz </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">parse</span><span style="color:#A6ACCD;">(question)</span></span></code></pre></div><p>Importing the library for simple web applications:</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">parse</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./pegjs-gift</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// Change path depending on where the file is copied.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> question </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">What is the value of pi (to 3 decimal places)? {#3.141..3.142}.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> quiz </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">parse</span><span style="color:#A6ACCD;">(question)</span></span></code></pre></div><p>Importing the NPM library in CommonJS (for use in Node.js applications):</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> parse </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">gift-pegjs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> question </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">What is the value of pi (to 3 decimal places)? {#3.141..3.142}.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> quiz </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">parse</span><span style="color:#A6ACCD;">(question)</span></span></code></pre></div><p>Using the optional Typescript types:</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">parse</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">GIFTQuestion</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">gift-pegjs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> question</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">What is the value of pi (to 3 decimal places)? {#3.141..3.142}.</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> quiz</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">GIFTQuestion</span><span style="color:#A6ACCD;">[] </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">parse</span><span style="color:#A6ACCD;">(question)</span></span></code></pre></div><h3 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">parse</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">gift-pegjs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> sampleQuestion </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#C3E88D;">Is this True? {T}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">Mahatma Gandhi&#39;s birthday is an Indian holiday on {</span></span>
<span class="line"><span style="color:#C3E88D;">~15th</span></span>
<span class="line"><span style="color:#C3E88D;">~3rd</span></span>
<span class="line"><span style="color:#C3E88D;">=2nd</span></span>
<span class="line"><span style="color:#C3E88D;">} of October.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">Since {</span></span>
<span class="line"><span style="color:#C3E88D;">  ~495 AD</span></span>
<span class="line"><span style="color:#C3E88D;">  =1066 AD</span></span>
<span class="line"><span style="color:#C3E88D;">  ~1215 AD</span></span>
<span class="line"><span style="color:#C3E88D;">  ~ 43 AD</span></span>
<span class="line"><span style="color:#C3E88D;">} the town of Hastings England has been &quot;famous with visitors&quot;.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">What is the value of pi (to 3 decimal places)? {#3.141..3.142}.</span></span>
<span class="line"><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> quizQuestions </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">parse</span><span style="color:#A6ACCD;">(sampleQuestion)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(quizQuestions)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="tests" tabindex="-1">Tests <a class="header-anchor" href="#tests" aria-label="Permalink to &quot;Tests&quot;">​</a></h3><p>There are <a href="https://mochajs.org/#dynamically-generating-tests" target="_blank" rel="noreferrer">easily extendible tests using Mocha</a> from sample GIFT/JSON files in <code>./test/questions/</code>.</p><p>To be able to run the tests, you must set up your environment:</p><ul><li><p><a href="https://nodejs.org/" target="_blank" rel="noreferrer">Install node.js</a></p></li><li><p>Clone this repo.</p></li><li><p>Install the node.js dependencies for this project. Inside the root directory of this repo, type:</p><pre><code>  npm install .
</code></pre></li><li><p>Run the regression tests with the following command:</p><pre><code>  npm test
</code></pre></li><li><p>Output will look something like this:</p><pre><code>  $ npm test

  &gt; gift-grammar-pegjs@1.0.0 test C:\\Users\\fuhrm\\Documents\\GitHub\\GIFT-grammar-PEG.js
  &gt; mocha tests --recursive



    GIFT parser harness:
  	√ parsing GIFT question: ./tests/questions/description1.gift
  	√ parsing GIFT question: ./tests/questions/essay1.gift
  	√ parsing GIFT question: ./tests/questions/giftFormatPhpExamples.gift
  	√ parsing GIFT question: ./tests/questions/matching1.gift
  	√ parsing GIFT question: ./tests/questions/mc1.gift
  	√ parsing GIFT question: ./tests/questions/mc2.gift
  	√ parsing GIFT question: ./tests/questions/mc3.gift
  	√ parsing GIFT question: ./tests/questions/mc4.gift
  	√ parsing GIFT question: ./tests/questions/mc5.gift
  	√ parsing GIFT question: ./tests/questions/multiLineFeedback1.gift
  	√ parsing GIFT question: ./tests/questions/numerical1.gift
  	√ parsing GIFT question: ./tests/questions/options1.gift
  	√ parsing GIFT question: ./tests/questions/shortAnswer1.gift
  	√ parsing GIFT question: ./tests/questions/tf1.gift
  	√ parsing GIFT question: ./tests/questions/tf2.gift


    15 passing (225ms)
</code></pre></li><li><p>To create a new test GIFT file, just name it <code>foo.gift</code> in <code>./test/questions/</code>. The JSON file <code>foo.json</code> should exist (expected output) and can be easily generated from the output at <a href="https://pegjs.org/online" target="_blank" rel="noreferrer">https://pegjs.org/online</a>. Note: any <code>undefined</code> values from that output must be declared as <code>null</code> in the JSON file.</p></li></ul><h2 id="gift-format" tabindex="-1">GIFT format <a class="header-anchor" href="#gift-format" aria-label="Permalink to &quot;GIFT format&quot;">​</a></h2><p><em>General Import Format Technology</em> (GIFT) is described at several places, but it&#39;s hard to know what the definitive source is.</p><p>This table is not sufficient to understand everything. Please see <a href="https://docs.moodle.org/en/GIFT_format" target="_blank" rel="noreferrer">Moodle&#39;s documentation</a> and <a href="http://buypct.com/gift_reference.pdf" target="_blank" rel="noreferrer">this reference</a> for many more details.</p><table><thead><tr><th>Symbols</th><th>Use</th></tr></thead><tbody><tr><td><code>//</code> <em>text</em></td><td>Comment until end of line (optional)</td></tr><tr><td><code>::</code><em>title</em><code>::</code></td><td>Question title (optional)</td></tr><tr><td><em>text</em></td><td>Question text (becomes title if no title specified)</td></tr><tr><td><code>[</code><em>format</em><code>]</code></td><td>The <em>format</em> of the following bit of text. Options are <code>[html]</code>, <code>[moodle]</code>, <code>[plain]</code> and <code>[markdown]</code>. The default is <code>[moodle]</code> for the question text, other parts of the question default to the format used for the question text.</td></tr><tr><td><code>{</code></td><td>Start answer(s) -- without any answers, text is a description of following questions</td></tr><tr><td><code>{T}</code> or <code>{F}</code></td><td>True or False answer; also <code>{TRUE}</code> and <code>{FALSE}</code></td></tr><tr><td><code>{</code> ... <code>=</code><em>right</em> ... <code>}</code></td><td>Correct answer for multiple choice, (multiple answer? -- see page comments) or fill-in-the-blank</td></tr><tr><td><code>{</code> ... <code>~</code><em>wrong</em> ... <code>}</code></td><td>Incorrect answer for multiple choice or multiple answer</td></tr><tr><td><code>{</code> ... <code>=</code><em>item</em> <code>-&gt;</code> <em>match</em> ... <code>}</code></td><td>Answer for matching questions</td></tr><tr><td><code>#</code><em>feedback text</em></td><td>Answer feedback for preceding multiple, fill-in-the-blank, or numeric answers</td></tr><tr><td><code>####</code><em>general feedback</em></td><td>General feedback</td></tr><tr><td><code>{#</code></td><td>Start numeric answer(s)</td></tr><tr><td>    <em>answer</em><code>:</code><em>tolerance</em></td><td>Numeric answer accepted within ± tolerance range</td></tr><tr><td>    <em>low</em><code>..</code><em>high</em></td><td>Lower and upper range values of accepted numeric answer</td></tr><tr><td>    <code>=%</code><em>n</em><code>%</code><em>answer</em><code>:</code><em>tolerance</em></td><td>n percent credit for one of multiple numeric ranges within tolerance from answer</td></tr><tr><td><code>}</code></td><td>End answer(s)</td></tr><tr><td><code>\\</code><em>character</em></td><td>Backslash escapes the special meaning of <code>~</code>, <code>=</code>, <code>#</code>, <code>{</code>, <code>}</code>, and <code>:</code></td></tr><tr><td><code>\\n</code></td><td>Places a newline in question text -- blank lines delimit questions</td></tr></tbody></table><p><a href="http://microformats.org/wiki/gift" target="_blank" rel="noreferrer">Source for above table</a></p><h2 id="background-information" tabindex="-1">Background information <a class="header-anchor" href="#background-information" aria-label="Permalink to &quot;Background information&quot;">​</a></h2><p>See these discussions in the Moodle forums:</p><ul><li><a href="https://moodle.org/mod/forum/discuss.php?d=259533" target="_blank" rel="noreferrer">Deriving a Formal GIFT Specification</a><ul><li><a href="https://moodle.org/mod/forum/discuss.php?d=259533#p1177669" target="_blank" rel="noreferrer">Creating 100 multichoice questions is quicker using GIFT.</a> --<a href="https://moodle.org/user/view.php?id=191052&amp;course=5" target="_blank" rel="noreferrer">Derek Chirnside</a></li></ul></li><li><a href="https://moodle.org/mod/forum/discuss.php?d=346431" target="_blank" rel="noreferrer">Suggesting using PEG.js with the GIFT spec</a></li></ul><p>See this <a href="https://git.moodle.org/gw?p=moodle.git;a=blob;f=question/format/gift/examples.txt;h=e65d4f0db6415e2f318f1d024864b33c75f80c69;hb=refs/heads/MOODLE_26_STABLE" target="_blank" rel="noreferrer">test file from Moodle&#39;s code base</a>.</p><h2 id="class-model-for-moodle-questions-quiz-format" tabindex="-1">Class model for Moodle questions (quiz) format <a class="header-anchor" href="#class-model-for-moodle-questions-quiz-format" aria-label="Permalink to &quot;Class model for Moodle questions (quiz) format&quot;">​</a></h2><p>The following UML class diagram is an interpretation of the XML format for Moodle quiz import/export. Note that the XML format is naive, e.g., the <code>QUESTION</code> tag is overloaded using <code>TYPE=</code> and as such can&#39;t easily be schema-tized. The interpretation below aims to facilitate the understanding of the content and relations. It&#39;s a domain model reverse-engineered from a data model.</p><p><img src="https://www.plantuml.com/plantuml/proxy?cache=no&amp;src=https://raw.githubusercontent.com/fuhrmanator/GIFT-grammar-PEG.js/master/MoodleQuestionDomainModel.txt&amp;fmt=svg" alt="UML class diagram (domain model) loosely based on XML structure"></p><h2 id="railroad-diagram-of-the-grammar" tabindex="-1">Railroad diagram of the grammar <a class="header-anchor" href="#railroad-diagram-of-the-grammar" aria-label="Permalink to &quot;Railroad diagram of the grammar&quot;">​</a></h2><p>Check out the <a href="https://dundalek.com/grammkit/#https://raw.githubusercontent.com/fuhrmanator/GIFT-grammar-PEG.js/master/GIFT.pegjs" target="_blank" rel="noreferrer">railroad diagram</a> for this project&#39;s PEG.</p><h2 id="testing-the-editor-locally" tabindex="-1">Testing the editor locally <a class="header-anchor" href="#testing-the-editor-locally" aria-label="Permalink to &quot;Testing the editor locally&quot;">​</a></h2><ul><li>In a terminal of the cloned repo: <code>node server.js</code></li><li>Point a browser to <a href="http://localhost:8181/docs/editor/editor.html" target="_blank" rel="noreferrer">http://localhost:8181/docs/editor/editor.html</a></li></ul>`,46),r=[n];function l(p,i,c,d,m,h){return s(),a("div",null,r)}const f=e(o,[["render",l]]);export{g as __pageData,f as default};
