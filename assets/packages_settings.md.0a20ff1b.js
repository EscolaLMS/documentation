import{_ as e,o as s,c as a,V as n}from"./chunks/framework.c495fe11.js";const u=JSON.parse('{"title":"Settings","description":"","frontmatter":{},"headers":[],"relativePath":"packages/settings.md","filePath":"packages/settings.md"}'),t={name:"packages/settings.md"},o=n(`<h1 id="settings" tabindex="-1">Settings <a class="header-anchor" href="#settings" aria-label="Permalink to &quot;Settings&quot;">​</a></h1><p>Configuration management package</p><p><a href="https://escolalms.github.io/settings/" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/documentation-swagger-green" alt="swagger"></a><a href="https://codecov.io/gh/EscolaLMS/settings" target="_blank" rel="noreferrer"><img src="https://codecov.io/gh/EscolaLMS/settings/branch/main/graph/badge.svg?token=gBzpyNK8DQ" alt="codecov"></a><a href="https://github.com/EscolaLMS/settings/actions/workflows/test.yml" target="_blank" rel="noreferrer"><img src="https://github.com/EscolaLMS/settings/actions/workflows/test.yml/badge.svg" alt="phpunit"></a><a href="https://packagist.org/packages/escolalms/settings" target="_blank" rel="noreferrer"><img src="https://img.shields.io/packagist/dt/escolalms/settings" alt="downloads"></a><a href="https://packagist.org/packages/escolalms/settings" target="_blank" rel="noreferrer"><img src="https://img.shields.io/packagist/v/escolalms/settings" alt="downloads"></a><a href="https://packagist.org/packages/escolalms/settings" target="_blank" rel="noreferrer"><img src="https://img.shields.io/packagist/l/escolalms/settings" alt="downloads"></a></p><h2 id="purpose" tabindex="-1">Purpose <a class="header-anchor" href="#purpose" aria-label="Permalink to &quot;Purpose&quot;">​</a></h2><p>This package can be used to register application config keys which can be then modified through API and/or Admin Panel.</p><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h2><ul><li><code>composer require escolalms/settings</code></li><li><code>php artisan migrate</code></li><li><code>php artisan db:seed --class=&quot;EscolaLms\\Settings\\Database\\Seeders\\PermissionTableSeeder&quot;</code></li><li>optional: <code>php artisan vendor:publish --tag=escola_settings.config</code> to publish config file</li></ul><h2 id="dependencies" tabindex="-1">Dependencies <a class="header-anchor" href="#dependencies" aria-label="Permalink to &quot;Dependencies&quot;">​</a></h2><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><h3 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h3><p>Config file contains <code>use_database</code> option, which determines if Config should be written and loaded to database (if <code>true</code>), or config files should be overwritten (if <code>false</code>);</p><h3 id="registering-config-keys" tabindex="-1">Registering config keys <a class="header-anchor" href="#registering-config-keys" aria-label="Permalink to &quot;Registering config keys&quot;">​</a></h3><p>Every package can register config keys by calling <code>registerConfig</code> static method from <code>AdministrableConfig</code> Facade in its own Package Service Provider <code>register</code> method.</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#A6ACCD;">EscolaLms</span><span style="color:#89DDFF;">\\</span><span style="color:#A6ACCD;">Settings</span><span style="color:#89DDFF;">\\</span><span style="color:#A6ACCD;">Facades</span><span style="color:#89DDFF;">\\</span><span style="color:#A6ACCD;">AdministrableConfig</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">register</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">AdministrableConfig</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">registerConfig</span><span style="color:#89DDFF;">($</span><span style="color:#A6ACCD;">key </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">config_file.config_key</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">rules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">required</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">string</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">],</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">public </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">readonly </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>When registering a configuration key you can:</p><ul><li>specify validation rules for values that can be stored (using any of rules available for Laravel validator)</li><li>specify if key is <code>public</code> (so anonymous users can retrieve the value)</li><li>specify if key is <code>readonly</code> (so it is returned by API but can not be changed using API)</li></ul><h3 id="loading-config" tabindex="-1">Loading config <a class="header-anchor" href="#loading-config" aria-label="Permalink to &quot;Loading config&quot;">​</a></h3><p>Config will be automatically loaded from database (if <code>use_database</code> config options is true). Otherwise, if overwriting config files is chosen, normal Laravel config loading mechanism is used.</p><h3 id="changing-config" tabindex="-1">Changing config <a class="header-anchor" href="#changing-config" aria-label="Permalink to &quot;Changing config&quot;">​</a></h3><p><code>EscolaLms\\Settings\\Facades\\AdministrableConfig</code> facade can also be used to modify and retrieve values for registered config keys.</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">AdministrableConfig</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">setConfig</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">array</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">config</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// sets config values for any registered config key in $config array, running validation rules</span></span>
<span class="line"><span style="color:#FFCB6B;">AdministrableConfig</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">getConfig</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// returns values for all registered config keys</span></span>
<span class="line"><span style="color:#FFCB6B;">AdministrableConfig</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">getPublicConfig</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// returns values for config keys registered with public: true</span></span></code></pre></div><p>These methods are utilised by web API of this package.</p><h3 id="config-repository-extension-config-rewriter" tabindex="-1">Config Repository Extension &amp; Config Rewriter <a class="header-anchor" href="#config-repository-extension-config-rewriter" aria-label="Permalink to &quot;Config Repository Extension &amp; Config Rewriter&quot;">​</a></h3><p>This package extends basic <code>config</code> Facade of Laravel Framework wrapping it in <code>EscolaLms\\Settings\\ConfigRewriter\\ConfigRepositoryExtension</code> decorator. This extended Config repository has a <code>write</code> method that can be called to store all in-memory changes to configuration values straight into config files. Writing operation tries to preserve structure of original config files (order of keys, comments, etc.) but it&#39;s not always possible (parses this package uses is WIP) and sometimes everything other than keys and values can be removed from config file. Using Database to store modified config values is a safer (non-destructive) option.</p><h2 id="endpoints" tabindex="-1">Endpoints <a class="header-anchor" href="#endpoints" aria-label="Permalink to &quot;Endpoints&quot;">​</a></h2><p>All the endpoints are defined in <a href="https://escolalms.github.io/settings/" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/documentation-swagger-green" alt="swagger"></a>.</p><h2 id="events" tabindex="-1">Events <a class="header-anchor" href="#events" aria-label="Permalink to &quot;Events&quot;">​</a></h2><ul><li><code>EscolaLms\\Settings\\Events\\SettingPackageConfigUpdated</code> emitted when settings are changed using web API.</li></ul><h2 id="listeners" tabindex="-1">Listeners <a class="header-anchor" href="#listeners" aria-label="Permalink to &quot;Listeners&quot;">​</a></h2><p>No Listeners are defined in this package.</p><h2 id="how-to-use-this-package-on-frontend" tabindex="-1">How to use this package on Frontend <a class="header-anchor" href="#how-to-use-this-package-on-frontend" aria-label="Permalink to &quot;How to use this package on Frontend&quot;">​</a></h2><h3 id="admin-panel" tabindex="-1">Admin Panel <a class="header-anchor" href="#admin-panel" aria-label="Permalink to &quot;Admin Panel&quot;">​</a></h3><h4 id="left-menu" tabindex="-1"><strong>Left menu</strong> <a class="header-anchor" href="#left-menu" aria-label="Permalink to &quot;**Left menu**&quot;">​</a></h4><p><img src="https://raw.githubusercontent.com/EscolaLMS/settings/main/docs/menu.png" alt="Admin panel menu" title="Admin panel menu"></p><h4 id="list-of-registered-settings-for-single-package-escolalms-auth-package-used-in-screenshot" tabindex="-1"><strong>List of registered Settings for single package (EscolaLms\\Auth package used in screenshot)</strong> <a class="header-anchor" href="#list-of-registered-settings-for-single-package-escolalms-auth-package-used-in-screenshot" aria-label="Permalink to &quot;**List of registered Settings for single package (EscolaLms\\Auth package used in screenshot)**&quot;">​</a></h4><p><img src="https://raw.githubusercontent.com/EscolaLMS/settings/main/docs/list.png" alt="List of registered settings for single package" title="List of registered settings for single package"></p><h4 id="editing-registered-setting" tabindex="-1"><strong>Editing registered Setting</strong> <a class="header-anchor" href="#editing-registered-setting" aria-label="Permalink to &quot;**Editing registered Setting**&quot;">​</a></h4><p><img src="https://raw.githubusercontent.com/EscolaLMS/settings/main/docs/edit.png" alt="Editing registered Setting" title="Editing registered Setting"></p><h2 id="tests" tabindex="-1">Tests <a class="header-anchor" href="#tests" aria-label="Permalink to &quot;Tests&quot;">​</a></h2><p>Run <code>./vendor/bin/phpunit --filter &#39;EscolaLms\\\\Settings\\\\Tests&#39;</code> to run tests. See <a href="https://github.com/EscolaLMS/settings/tree/main/tests" target="_blank" rel="noreferrer">tests</a> folder as it&#39;s quite good staring point as documentation appendix.</p><p>Test details: <a href="https://codecov.io/gh/EscolaLMS/settings" target="_blank" rel="noreferrer"><img src="https://codecov.io/gh/EscolaLMS/settings/branch/main/graph/badge.svg?token=gBzpyNK8DQ" alt="codecov"></a><a href="https://github.com/EscolaLMS/settings/actions/workflows/test.yml" target="_blank" rel="noreferrer"><img src="https://github.com/EscolaLMS/settings/actions/workflows/test.yml/badge.svg" alt="phpunit"></a></p><h2 id="permissions" tabindex="-1">Permissions <a class="header-anchor" href="#permissions" aria-label="Permalink to &quot;Permissions&quot;">​</a></h2><p>Permissions are defined in <a href="https://github.com/EscolaLMS/settings/tree/main/src/Enums/ReportsPermissionsEnum.php" target="_blank" rel="noreferrer">Enum</a> and seeded in <a href="database/seeders/ReportsPermissionSeeder.php">Seeder</a>.</p><h2 id="roadmap-todo-troubleshooting" tabindex="-1">Roadmap. Todo. Troubleshooting <a class="header-anchor" href="#roadmap-todo-troubleshooting" aria-label="Permalink to &quot;Roadmap. Todo. Troubleshooting&quot;">​</a></h2><ul><li>Describe what &quot;Settings&quot; part of this package does (as only &quot;Config&quot; was described, and this package has/had second purpose)</li></ul>`,45),i=[o];function r(l,c,p,g,d,h){return s(),a("div",null,i)}const m=e(t,[["render",r]]);export{u as __pageData,m as default};
