(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{452:function(t,a){t.exports="data:image/png;base64,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"},453:function(t,a,s){t.exports=s.p+"assets/img/list.a56a6d34.png"},585:function(t,a,s){"use strict";s.r(a);var e=s(65),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"payments"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#payments"}},[t._v("#")]),t._v(" Payments")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://escolalms.github.io/payments/",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img.shields.io/badge/documentation-swagger-green",alt:"swagger"}}),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://codecov.io/gh/EscolaLMS/payments",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://codecov.io/gh/EscolaLMS/Files/branch/main/graph/badge.svg?token=NRAN4R8AGZ",alt:"codecov"}}),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/EscolaLMS/payments/actions/workflows/test.yml",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://github.com/EscolaLMS/payments/actions/workflows/test.yml/badge.svg",alt:"phpunit"}}),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://packagist.org/packages/escolalms/payments",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img.shields.io/packagist/dt/escolalms/payments",alt:"downloads"}}),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://packagist.org/packages/escolalms/payments",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img.shields.io/packagist/v/escolalms/payments",alt:"downloads"}}),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://packagist.org/packages/escolalms/payments",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img.shields.io/packagist/l/escolalms/payments",alt:"downloads"}}),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://codeclimate.com/github/EscolaLMS/payments/maintainability",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://api.codeclimate.com/v1/badges/e42a94f20c76b719fc38/maintainability",alt:"Maintainability"}}),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"purpose"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#purpose"}},[t._v("#")]),t._v(" Purpose")]),t._v(" "),e("p",[t._v("This package lets you create Payments and process them using integrations with external payment providers (gateways).")]),t._v(" "),e("h2",{attrs:{id:"dependencies"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dependencies"}},[t._v("#")]),t._v(" Dependencies")]),t._v(" "),e("ul",[e("li",[t._v("Stripe integration is based on "),e("code",[t._v("league/omnipay")]),t._v(" and "),e("code",[t._v("omnipay/stripe")]),t._v(" packages.")]),t._v(" "),e("li",[t._v("Przelewy24 integration is based on "),e("code",[t._v("mnastalski/przelewy24-php")]),t._v(" package.")]),t._v(" "),e("li",[t._v("Optional integration with "),e("code",[t._v("escolalms/settings")]),t._v(" package enables changing payment gateway api keys & secrets using Settings API (and Admin Panel).")])]),t._v(" "),e("h2",{attrs:{id:"installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("composer require escolalms/payments")])]),t._v(" "),e("li",[e("code",[t._v("php artisan migrate")])]),t._v(" "),e("li",[e("code",[t._v('php artisan db:seed --class="EscolaLms\\Cart\\Database\\Seeders\\CartPermissionSeeder"')])])]),t._v(" "),e("h2",{attrs:{id:"usage"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[t._v("#")]),t._v(" Usage")]),t._v(" "),e("h3",{attrs:{id:"facades"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#facades"}},[t._v("#")]),t._v(" Facades")]),t._v(" "),e("h4",{attrs:{id:"payments-facade"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#payments-facade"}},[t._v("#")]),t._v(" Payments Facade")]),t._v(" "),e("p",[t._v("Use "),e("code",[t._v("EscolaLms\\Payments\\Facades\\Payments")]),t._v(" for starting payment processing.\nYou can create PaymentProcessor` either from a model using Payable trait or from precreated Payment object.")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cart"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Models"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Cart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payments"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Dtos"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PaymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payments"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Facades"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$payable")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Cart")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Cart must implement Payable interface and use Payable trait")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentMethodDto")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("PaymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("instantiateFromRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$processor")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Payments")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("processPayment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$payable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$processor")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("purchase")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// will emit PaymentPaid event on success")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$payment")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("status")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("is")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("PaymentStatus")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PAID")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h4",{attrs:{id:"paymentgateway-facade"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#paymentgateway-facade"}},[t._v("#")]),t._v(" PaymentGateway Facade")]),t._v(" "),e("p",[t._v("With "),e("code",[t._v("EscolaLms\\Payments\\Facades\\PaymentGateway")]),t._v(" you can call payment provider gateways directly.")]),t._v(" "),e("p",[t._v("For existing payment you can for example do:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payments"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Dtos"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PaymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payments"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Facades"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PaymentGateway")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payments"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Models"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$payment")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Payment")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentMethodDto")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("PaymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("instantiateFromRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentDto")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("PaymentDto")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("instantiateFromPayment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$payment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// or you can create it manually")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("PaymentGateway")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("purchase")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentDto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// will use default payment driver")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Important")]),t._v(": This will not save "),e("code",[t._v("Payment")]),t._v(" object.")]),t._v(" "),e("p",[t._v("To use specific driver, you can call")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("PaymentGateway")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("driver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'stripe'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("purchase")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentDto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h4",{attrs:{id:"available-payment-drivers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#available-payment-drivers"}},[t._v("#")]),t._v(" Available payment drivers")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("stripe")]),t._v(" (using "),e("code",[t._v("Stripe Payment Intent")]),t._v(")")]),t._v(" "),e("li",[e("strong",[t._v("free")])]),t._v(" "),e("li",[e("strong",[t._v("przelewy24")])]),t._v(" "),e("li",[t._v("TODO: "),e("em",[t._v("stripe-checkout")])])]),t._v(" "),e("h3",{attrs:{id:"payable-trait-interface"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#payable-trait-interface"}},[t._v("#")]),t._v(" Payable Trait & Interface")]),t._v(" "),e("p",[e("code",[t._v("Payable")]),t._v(" trait and interface are the core of this package, enabling simplified calling of "),e("code",[t._v("PaymentsService")]),t._v(" and "),e("code",[t._v("GatewayManager")]),t._v(".\nWhen you include it in your model that represents a "),e("code",[t._v("Payable")]),t._v(" (for example "),e("code",[t._v("Cart")]),t._v(" or "),e("code",[t._v("Order")]),t._v(" or "),e("code",[t._v("Product")]),t._v(") you can begin payment processing for that "),e("code",[t._v("Payable")]),t._v(" by calling "),e("code",[t._v("$payable->process()")]),t._v("\nwhich calls "),e("code",[t._v("Payments::processPayable($this)")]),t._v(" and automatically creates a "),e("code",[t._v("Payment")]),t._v(" and returns a "),e("code",[t._v("PaymentProcessor")]),t._v(" instance for that Payment.")]),t._v(" "),e("p",[e("code",[t._v("EscolaLms\\Cart")]),t._v(" package uses this trait and interface in "),e("code",[t._v("EscolaLms\\Cart\\Models\\Order")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"payment-processor"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#payment-processor"}},[t._v("#")]),t._v(" Payment Processor")]),t._v(" "),e("p",[e("code",[t._v("EscolaLms\\Payments\\Entities\\PaymentProcessor")]),t._v(" is a special class which wraps around "),e("code",[t._v("Payment")]),t._v("\nand contains functionality related to processing that payment, for example generating links to payment gateways, automatically setting payment status after purchase, emiting events related to payment status, etc.")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payments"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Dtos"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PaymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payments"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Entities"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PaymentProcessor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payments"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Models"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Payment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$payment")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Payment")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentMethodDto")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("PaymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("instantiateFromRequest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$processor")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PaymentProcessor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$payment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// instead of using Payments facade")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$processor")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("purchase")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$paymentMethodDto")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("code",[t._v("PaymentProcessor")]),t._v(" automatically selects "),e("code",[t._v("free")]),t._v(" driver when payment amount equals 0.")]),t._v(" "),e("h3",{attrs:{id:"payment-model"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#payment-model"}},[t._v("#")]),t._v(" Payment Model")]),t._v(" "),e("p",[t._v("This package defines a "),e("code",[t._v("EscolaLms\\Payments\\Models\\Payment")]),t._v(" which contains all data abount given payment required for payment gateways to work.")]),t._v(" "),e("h2",{attrs:{id:"endpoints"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#endpoints"}},[t._v("#")]),t._v(" Endpoints")]),t._v(" "),e("p",[t._v("All the endpoints are defined in "),e("a",{attrs:{href:"https://escolalms.github.io/payments/",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://img.shields.io/badge/documentation-swagger-green",alt:"swagger"}}),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"tests"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tests"}},[t._v("#")]),t._v(" Tests")]),t._v(" "),e("p",[t._v("Run "),e("code",[t._v("./vendor/bin/phpunit")]),t._v(" to run tests. See "),e("a",{attrs:{href:"tests/Mocks/Payable.php"}},[t._v("tests/Mocks/Payable")]),t._v(" as an example how a Payable is defined.")]),t._v(" "),e("p",[t._v("Test details: "),e("a",{attrs:{href:"https://codecov.io/gh/EscolaLMS/payments",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://codecov.io/gh/EscolaLMS/Files/branch/main/graph/badge.svg?token=NRAN4R8AGZ",alt:"codecov"}}),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://github.com/EscolaLMS/payments/actions/workflows/test.yml",target:"_blank",rel:"noopener noreferrer"}},[e("img",{attrs:{src:"https://github.com/EscolaLMS/payments/actions/workflows/test.yml/badge.svg",alt:"phpunit"}}),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"events"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[t._v("#")]),t._v(" Events")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("EscolaLms\\Payments\\Events\\PaymentCancelled")]),t._v(" - - emited after payment processing is cancelled (by user action or possibly by timeout sent from payment gateway)")]),t._v(" "),e("li",[e("code",[t._v("EscolaLms\\Payments\\Events\\PaymentFailed")]),t._v(" - emited after payment has failed (payment gateway returns error)")]),t._v(" "),e("li",[e("code",[t._v("EscolaLms\\Payments\\Events\\PaymentRegistered")]),t._v(" - emited when new Payment is created")]),t._v(" "),e("li",[e("code",[t._v("EscolaLms\\Payments\\Events\\PaymentSuccess")]),t._v(" - emited when payment gateway returns success")])]),t._v(" "),e("h2",{attrs:{id:"listeners"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#listeners"}},[t._v("#")]),t._v(" Listeners")]),t._v(" "),e("p",[t._v("No Listeners are defined in this package.")]),t._v(" "),e("h2",{attrs:{id:"how-to-use-this-package-on-frontend"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-this-package-on-frontend"}},[t._v("#")]),t._v(" How to use this package on Frontend")]),t._v(" "),e("h3",{attrs:{id:"admin-panel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#admin-panel"}},[t._v("#")]),t._v(" Admin Panel")]),t._v(" "),e("h4",{attrs:{id:"left-menu"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#left-menu"}},[t._v("#")]),t._v(" "),e("strong",[t._v("Left Menu")])]),t._v(" "),e("p",[e("img",{attrs:{src:s(452),alt:"Admin panel menu",title:"Admin panel menu"}})]),t._v(" "),e("h4",{attrs:{id:"list-of-payments"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#list-of-payments"}},[t._v("#")]),t._v(" "),e("strong",[t._v("List of Payments")])]),t._v(" "),e("p",[e("img",{attrs:{src:s(453),alt:"List of Payments",title:"List of Payments"}})]),t._v(" "),e("h2",{attrs:{id:"permissions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#permissions"}},[t._v("#")]),t._v(" Permissions")]),t._v(" "),e("p",[t._v("Permissions are defined in "),e("a",{attrs:{href:"https://github.com/EscolaLMS/Payments/blob/main/src/Enums/CartPermissionsEnum.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("Enum"),e("OutboundLink")],1),t._v(" and seeded in "),e("a",{attrs:{href:"https://github.com/EscolaLMS/Payments/blob/main/database/seeders/CartPermissionSeeder.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("Seeder"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"roadmap-todo-troubleshooting"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#roadmap-todo-troubleshooting"}},[t._v("#")]),t._v(" Roadmap. Todo. Troubleshooting")]),t._v(" "),e("ul",[e("li",[t._v("???")])])])}),[],!1,null,null,null);a.default=n.exports}}]);