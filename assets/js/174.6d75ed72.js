(window.webpackJsonp=window.webpackJsonp||[]).push([[174],{467:function(t,s,e){"use strict";e.r(s);var a=e(10),n=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"settings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#settings"}},[t._v("#")]),t._v(" Settings")]),t._v(" "),s("p",[t._v("Configuration management package")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://escolalms.github.io/settings/",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://img.shields.io/badge/documentation-swagger-green",alt:"swagger"}}),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://codecov.io/gh/EscolaLMS/settings",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://codecov.io/gh/EscolaLMS/settings/branch/main/graph/badge.svg?token=gBzpyNK8DQ",alt:"codecov"}}),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/EscolaLMS/settings/actions/workflows/test.yml",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://github.com/EscolaLMS/settings/actions/workflows/test.yml/badge.svg",alt:"phpunit"}}),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://packagist.org/packages/escolalms/settings",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://img.shields.io/packagist/dt/escolalms/settings",alt:"downloads"}}),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://packagist.org/packages/escolalms/settings",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://img.shields.io/packagist/v/escolalms/settings",alt:"downloads"}}),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://packagist.org/packages/escolalms/settings",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://img.shields.io/packagist/l/escolalms/settings",alt:"downloads"}}),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"purpose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#purpose"}},[t._v("#")]),t._v(" Purpose")]),t._v(" "),s("p",[t._v("This package can be used to register application config keys which can be then modified through API and/or Admin Panel.")]),t._v(" "),s("h2",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("composer require escolalms/settings")])]),t._v(" "),s("li",[s("code",[t._v("php artisan migrate")])]),t._v(" "),s("li",[s("code",[t._v('php artisan db:seed --class="EscolaLms\\Settings\\Database\\Seeders\\PermissionTableSeeder"')])]),t._v(" "),s("li",[t._v("optional: "),s("code",[t._v("php artisan vendor:publish --tag=escola_settings.config")]),t._v(" to publish config file")])]),t._v(" "),s("h2",{attrs:{id:"dependencies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dependencies"}},[t._v("#")]),t._v(" Dependencies")]),t._v(" "),s("h2",{attrs:{id:"usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usage"}},[t._v("#")]),t._v(" Usage")]),t._v(" "),s("h3",{attrs:{id:"configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[t._v("#")]),t._v(" Configuration")]),t._v(" "),s("p",[t._v("Config file contains "),s("code",[t._v("use_database")]),t._v(" option, which determines if Config should be written and loaded to database (if "),s("code",[t._v("true")]),t._v("), or config files should be overwritten (if "),s("code",[t._v("false")]),t._v(");")]),t._v(" "),s("h3",{attrs:{id:"registering-config-keys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#registering-config-keys"}},[t._v("#")]),t._v(" Registering config keys")]),t._v(" "),s("p",[t._v("Every package can register config keys by calling "),s("code",[t._v("registerConfig")]),t._v(" static method from "),s("code",[t._v("AdministrableConfig")]),t._v(" Facade in its own Package Service Provider "),s("code",[t._v("register")]),t._v(" method.")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("EscolaLms"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Settings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Facades"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AdministrableConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("register")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("AdministrableConfig")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$key")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'config_file.config_key'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$rules")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'required'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'string'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$readonly")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("p",[t._v("When registering a configuration key you can:")]),t._v(" "),s("ul",[s("li",[t._v("specify validation rules for values that can be stored (using any of rules available for Laravel validator)")]),t._v(" "),s("li",[t._v("specify if key is "),s("code",[t._v("public")]),t._v(" (so anonymous users can retrieve the value)")]),t._v(" "),s("li",[t._v("specify if key is "),s("code",[t._v("readonly")]),t._v(" (so it is returned by API but can not be changed using API)")])]),t._v(" "),s("h3",{attrs:{id:"loading-config"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#loading-config"}},[t._v("#")]),t._v(" Loading config")]),t._v(" "),s("p",[t._v("Config will be automatically loaded from database (if "),s("code",[t._v("use_database")]),t._v(" config options is true). Otherwise, if overwriting config files is chosen, normal Laravel config loading mechanism is used.")]),t._v(" "),s("h3",{attrs:{id:"changing-config"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#changing-config"}},[t._v("#")]),t._v(" Changing config")]),t._v(" "),s("p",[s("code",[t._v("EscolaLms\\Settings\\Facades\\AdministrableConfig")]),t._v(" facade can also be used to modify and retrieve values for registered config keys.")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("AdministrableConfig")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword type-hint"}},[t._v("array")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sets config values for any registered config key in $config array, running validation rules")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("AdministrableConfig")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// returns values for all registered config keys")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("AdministrableConfig")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPublicConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// returns values for config keys registered with public: true")]),t._v("\n")])])]),s("p",[t._v("These methods are utilised by web API of this package.")]),t._v(" "),s("h3",{attrs:{id:"config-repository-extension-config-rewriter"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#config-repository-extension-config-rewriter"}},[t._v("#")]),t._v(" Config Repository Extension & Config Rewriter")]),t._v(" "),s("p",[t._v("This package extends basic "),s("code",[t._v("config")]),t._v(" Facade of Laravel Framework wrapping it in "),s("code",[t._v("EscolaLms\\Settings\\ConfigRewriter\\ConfigRepositoryExtension")]),t._v(" decorator. This extended Config repository has a "),s("code",[t._v("write")]),t._v(" method that can be called to store all in-memory changes to configuration values straight into config files. Writing operation tries to preserve structure of original config files (order of keys, comments, etc.) but it's not always possible (parses this package uses is WIP) and sometimes everything other than keys and values can be removed from config file. Using Database to store modified config values is a safer (non-destructive) option.")]),t._v(" "),s("h2",{attrs:{id:"endpoints"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#endpoints"}},[t._v("#")]),t._v(" Endpoints")]),t._v(" "),s("p",[t._v("All the endpoints are defined in "),s("a",{attrs:{href:"https://escolalms.github.io/settings/",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://img.shields.io/badge/documentation-swagger-green",alt:"swagger"}}),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h2",{attrs:{id:"events"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[t._v("#")]),t._v(" Events")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("EscolaLms\\Settings\\Events\\SettingPackageConfigUpdated")]),t._v(" emitted when settings are changed using web API.")])]),t._v(" "),s("h2",{attrs:{id:"listeners"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#listeners"}},[t._v("#")]),t._v(" Listeners")]),t._v(" "),s("p",[t._v("No Listeners are defined in this package.")]),t._v(" "),s("h2",{attrs:{id:"how-to-use-this-package-on-frontend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-this-package-on-frontend"}},[t._v("#")]),t._v(" How to use this package on Frontend")]),t._v(" "),s("h3",{attrs:{id:"admin-panel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#admin-panel"}},[t._v("#")]),t._v(" Admin Panel")]),t._v(" "),s("h4",{attrs:{id:"left-menu"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#left-menu"}},[t._v("#")]),t._v(" "),s("strong",[t._v("Left menu")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/EscolaLMS/settings/main/docs/menu.png",alt:"Admin panel menu",title:"Admin panel menu"}})]),t._v(" "),s("h4",{attrs:{id:"list-of-registered-settings-for-single-package-escolalms-auth-package-used-in-screenshot"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#list-of-registered-settings-for-single-package-escolalms-auth-package-used-in-screenshot"}},[t._v("#")]),t._v(" "),s("strong",[t._v("List of registered Settings for single package (EscolaLms\\Auth package used in screenshot)")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/EscolaLMS/settings/main/docs/list.png",alt:"List of registered settings for single package",title:"List of registered settings for single package"}})]),t._v(" "),s("h4",{attrs:{id:"editing-registered-setting"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#editing-registered-setting"}},[t._v("#")]),t._v(" "),s("strong",[t._v("Editing registered Setting")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/EscolaLMS/settings/main/docs/edit.png",alt:"Editing registered Setting",title:"Editing registered Setting"}})]),t._v(" "),s("h2",{attrs:{id:"tests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tests"}},[t._v("#")]),t._v(" Tests")]),t._v(" "),s("p",[t._v("Run "),s("code",[t._v("./vendor/bin/phpunit --filter 'EscolaLms\\\\Settings\\\\Tests'")]),t._v(" to run tests. See "),s("a",{attrs:{href:"https://github.com/EscolaLMS/settings/tree/main/tests",target:"_blank",rel:"noopener noreferrer"}},[t._v("tests"),s("OutboundLink")],1),t._v(" folder as it's quite good staring point as documentation appendix.")]),t._v(" "),s("p",[t._v("Test details:\n"),s("a",{attrs:{href:"https://codecov.io/gh/EscolaLMS/settings",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://codecov.io/gh/EscolaLMS/settings/branch/main/graph/badge.svg?token=gBzpyNK8DQ",alt:"codecov"}}),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://github.com/EscolaLMS/settings/actions/workflows/test.yml",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://github.com/EscolaLMS/settings/actions/workflows/test.yml/badge.svg",alt:"phpunit"}}),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"permissions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#permissions"}},[t._v("#")]),t._v(" Permissions")]),t._v(" "),s("p",[t._v("Permissions are defined in "),s("a",{attrs:{href:"https://github.com/EscolaLMS/settings/tree/main/src/Enums/ReportsPermissionsEnum.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("Enum"),s("OutboundLink")],1),t._v(" and seeded in "),s("a",{attrs:{href:"database/seeders/ReportsPermissionSeeder.php"}},[t._v("Seeder")]),t._v(".")]),t._v(" "),s("h2",{attrs:{id:"roadmap-todo-troubleshooting"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#roadmap-todo-troubleshooting"}},[t._v("#")]),t._v(" Roadmap. Todo. Troubleshooting")]),t._v(" "),s("ul",[s("li",[t._v('Describe what "Settings" part of this package does (as only "Config" was described, and this package has/had second purpose)')])])])}),[],!1,null,null,null);s.default=n.exports}}]);