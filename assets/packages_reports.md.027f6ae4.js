import{_ as e,o as a,c as t,V as o}from"./chunks/framework.c495fe11.js";const g=JSON.parse('{"title":"EscolaLMS Reports","description":"","frontmatter":{},"headers":[],"relativePath":"packages/reports.md","filePath":"packages/reports.md"}'),s={name:"packages/reports.md"},r=o('<h1 id="escolalms-reports" tabindex="-1">EscolaLMS Reports <a class="header-anchor" href="#escolalms-reports" aria-label="Permalink to &quot;EscolaLMS Reports&quot;">​</a></h1><p>Package for statistics &amp; reports</p><p><a href="https://escolalms.github.io/Reports/" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/documentation-swagger-green" alt="swagger"></a><a href="https://codecov.io/gh/EscolaLMS/Reports" target="_blank" rel="noreferrer"><img src="https://codecov.io/gh/EscolaLMS/Reports/branch/main/graph/badge.svg?token=O91FHNKI6R" alt="codecov"></a><a href="https://github.com/EscolaLMS/Reports/actions/workflows/test.yml" target="_blank" rel="noreferrer"><img src="https://github.com/EscolaLMS/Reports/actions/workflows/test.yml/badge.svg" alt="phpunit"></a><a href="https://packagist.org/packages/escolalms/reports" target="_blank" rel="noreferrer"><img src="https://img.shields.io/packagist/dt/escolalms/reports" alt="downloads"></a><a href="https://packagist.org/packages/escolalms/reports" target="_blank" rel="noreferrer"><img src="https://img.shields.io/packagist/v/escolalms/reports" alt="downloads"></a><a href="https://packagist.org/packages/escolalms/reports" target="_blank" rel="noreferrer"><img src="https://img.shields.io/packagist/l/escolalms/reports" alt="downloads"></a></p><h2 id="purpose" tabindex="-1">Purpose <a class="header-anchor" href="#purpose" aria-label="Permalink to &quot;Purpose&quot;">​</a></h2><p>This package contains web API for retrieving statistical data about other LMS components (or event any arbitrary non-LMS Models for which Metrics and/or Reports are registered).</p><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h2><ul><li><code>composer require escolalms/reports</code></li><li><code>php artisan migrate</code></li><li><code>php artisan db:seed --class=&quot;EscolaLms\\Reports\\Database\\Seeders\\ReportsPermissionSeeder&quot;</code></li><li>optional: <code>php artisan vendor:publish --tag=reports</code> to publish config file</li></ul><h2 id="dependencies" tabindex="-1">Dependencies <a class="header-anchor" href="#dependencies" aria-label="Permalink to &quot;Dependencies&quot;">​</a></h2><ul><li><code>EscolaLms\\Courses</code> for all Courses related stats and metrics</li><li><code>EscolaLms\\Cart</code> for all metrics related to calculating amounts of money spent</li></ul><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><h3 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h3><p>By editing published config <code>reports.php</code> you can:</p><ol><li>Change which metrics are available in API (by editing <code>metrics</code>)</li><li>Change settings for each Metric (by editing <code>metric_configuration</code>) <ol><li><code>limit</code> defines how many data points will be calculated by default (if you don&#39;t pass limit as query parameter); for example: <code>TutorsPopularityMetric</code> with <code>limit</code> set to 10 will return popularity of 10 most popular Tutors</li><li><code>history</code> is a boolean that defines if this metric should be automatically calculated and stored in database</li><li><code>cron</code> is cron config which determines how often automatic calculation of metrics happens</li></ol></li><li>Change which stats are available in API (by editing <code>stats</code>) and to which Model they are mapped</li></ol><h3 id="stats" tabindex="-1">Stats <a class="header-anchor" href="#stats" aria-label="Permalink to &quot;Stats&quot;">​</a></h3><p>Stats are used for calculating some statistical data about given single Model (for example Course or Topic). No historical data is stored, only current data is available.</p><h4 id="available-stats" tabindex="-1"><strong>Available stats</strong> <a class="header-anchor" href="#available-stats" aria-label="Permalink to &quot;**Available stats**&quot;">​</a></h4><ul><li><code>EscolaLms\\Reports\\Stats\\Course\\AverageTime</code> - average time spent on Course by users subscribed to it</li><li><code>EscolaLms\\Reports\\Stats\\Course\\AverageTimePerTopic</code> - average time spent on Course by users subscribed to it, grouped by topic</li><li><code>EscolaLms\\Reports\\Stats\\Course\\MoneyEarned</code> - sum of money earned by given Course</li><li><code>EscolaLms\\Reports\\Stats\\Course\\PeopleBought</code> - count of users that bought given Course</li><li><code>EscolaLms\\Reports\\Stats\\Course\\PeopleFinished</code> - count of how many users finished given Course</li><li><code>EscolaLms\\Reports\\Stats\\Course\\PeopleStarted</code> - count of how many users started learning given Course</li><li><code>EscolaLms\\Reports\\Stats\\Topic\\AverageTime</code> - average time spent on Topic by users subscribed to Course which this topic is part of</li></ul><h4 id="creating-your-own-stat" tabindex="-1"><strong>Creating your own stat</strong> <a class="header-anchor" href="#creating-your-own-stat" aria-label="Permalink to &quot;**Creating your own stat**&quot;">​</a></h4><p>To create your own Stat, you need to create class implementing <code>EscolaLms\\Reports\\Stats\\StatContract</code>. After creating a Stat you need to register it by adding it to <code>stats</code> array in config file.</p><h3 id="metrics" tabindex="-1">Metrics <a class="header-anchor" href="#metrics" aria-label="Permalink to &quot;Metrics&quot;">​</a></h3><p>Metrics are used for reporting data accumulated over time. Historical data is stored for each day using scheduled job, and requesting a metric returns that historical data (that is, metric values stored at given date).</p><h4 id="available-metrics" tabindex="-1"><strong>Available metrics</strong> <a class="header-anchor" href="#available-metrics" aria-label="Permalink to &quot;**Available metrics**&quot;">​</a></h4><ul><li><code>EscolaLms\\Reports\\Metrics\\CoursesMoneySpentMetric</code> - calculates total money spent for every Course (historical data represents total money spent up to given date)</li><li><code>EscolaLms\\Reports\\Metrics\\CoursesPopularityMetric</code> - calculates how many users were subscribed to every Course</li><li><code>EscolaLms\\Reports\\Metrics\\CoursesSecondsSpentMetric</code> - calculates how much times users spent learning every Course</li><li><code>EscolaLms\\Reports\\Metrics\\TutorsPopularityMetric</code> - calculates how many users were subscribed to courses created by given Tutor</li></ul><h4 id="creating-your-own-metric" tabindex="-1"><strong>Creating your own metric</strong> <a class="header-anchor" href="#creating-your-own-metric" aria-label="Permalink to &quot;**Creating your own metric**&quot;">​</a></h4><p>To create your own Metric, you need to create class implementing <code>EscolaLms\\Reports\\Metrics\\Contracts\\MetricContract</code>. You can extend <code>EscolaLms\\Reports\\Metrics\\AbstractMetric</code> to use default implementations of most of the methods declared in this interface. After creating a Metric you need to register it by adding it to <code>metrics</code> array in config file.</p><h2 id="endpoints" tabindex="-1">Endpoints <a class="header-anchor" href="#endpoints" aria-label="Permalink to &quot;Endpoints&quot;">​</a></h2><p>All the endpoints are defined in <a href="https://escolalms.github.io/reports/" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/documentation-swagger-green" alt="swagger"></a>.</p><h3 id="metrics-endpoints" tabindex="-1">Metrics endpoints <a class="header-anchor" href="#metrics-endpoints" aria-label="Permalink to &quot;Metrics endpoints&quot;">​</a></h3><ol><li><code>GET /api/admin/reports/metrics</code> returns list of <code>metrics</code> configured in <code>reports.php</code> config file</li><li><code>GET /api/admin/reports/report</code> calculates data for chosen metric; you can pass following query parameters to this endpoint: <ol><li><code>metric={classname}</code> is required; <code>classname</code> is one of the <code>metrics</code> returned in <code>/api/admin/reports/metrics</code> endpoit</li><li><code>limit={int}</code> is optional; determines the maximum number of data points that will be returned</li><li><code>date={date}</code> is optional; will try to load historical report data for given date or return <code>404</code> if there is no data available; without this param, endpoint will return today&#39;s data</li></ol></li></ol><h3 id="stats-endpoints" tabindex="-1">Stats endpoints <a class="header-anchor" href="#stats-endpoints" aria-label="Permalink to &quot;Stats endpoints&quot;">​</a></h3><ol><li><code>GET /api/admin/stats/available</code> returns list of <code>stats</code> configured in <code>reports.php</code> config file</li><li>`GET /api/admin/stats/</li></ol><h2 id="tests" tabindex="-1">Tests <a class="header-anchor" href="#tests" aria-label="Permalink to &quot;Tests&quot;">​</a></h2><p>Run <code>./vendor/bin/phpunit --filter=&#39;EscolaLms\\\\Reports\\\\Tests&#39;</code> to run tests.</p><p>Test details: <a href="https://codecov.io/gh/EscolaLMS/Reports" target="_blank" rel="noreferrer"><img src="https://codecov.io/gh/EscolaLMS/Reports/branch/main/graph/badge.svg?token=O91FHNKI6R" alt="codecov"></a><a href="https://github.com/EscolaLMS/Reports/actions/workflows/test.yml" target="_blank" rel="noreferrer"><img src="https://github.com/EscolaLMS/Reports/actions/workflows/test.yml/badge.svg" alt="phpunit"></a></p><h2 id="events" tabindex="-1">Events <a class="header-anchor" href="#events" aria-label="Permalink to &quot;Events&quot;">​</a></h2><p>No Events are defined in this package.</p><h2 id="listeners" tabindex="-1">Listeners <a class="header-anchor" href="#listeners" aria-label="Permalink to &quot;Listeners&quot;">​</a></h2><p>No Listeners are defined in this package.</p><h2 id="how-to-use-this-package-on-frontend" tabindex="-1">How to use this package on Frontend <a class="header-anchor" href="#how-to-use-this-package-on-frontend" aria-label="Permalink to &quot;How to use this package on Frontend&quot;">​</a></h2><h3 id="admin-panel" tabindex="-1">Admin Panel <a class="header-anchor" href="#admin-panel" aria-label="Permalink to &quot;Admin Panel&quot;">​</a></h3><h4 id="reports-dashboard" tabindex="-1"><strong>Reports dashboard</strong> <a class="header-anchor" href="#reports-dashboard" aria-label="Permalink to &quot;**Reports dashboard**&quot;">​</a></h4><p><img src="https://raw.githubusercontent.com/EscolaLMS/Reports/main/docs/reports.png" alt="Reports dashboard" title="Reports dashboard"></p><h4 id="course-stats" tabindex="-1"><strong>Course Stats</strong> <a class="header-anchor" href="#course-stats" aria-label="Permalink to &quot;**Course Stats**&quot;">​</a></h4><p><img src="https://raw.githubusercontent.com/EscolaLMS/Reports/main/docs/course.png" alt="Course statistics" title="Course statistics"></p><h2 id="permissions" tabindex="-1">Permissions <a class="header-anchor" href="#permissions" aria-label="Permalink to &quot;Permissions&quot;">​</a></h2><p>Permissions are defined in <a href="https://github.com/EscolaLMS/Reports/tree/main/src/Enums/ReportsPermissionsEnum.php" target="_blank" rel="noreferrer">Enum</a> and seeded in <a href="database/seeders/ReportsPermissionSeeder.php">Seeder</a>.</p><h2 id="roadmap-todo-troubleshooting" tabindex="-1">Roadmap. Todo. Troubleshooting <a class="header-anchor" href="#roadmap-todo-troubleshooting" aria-label="Permalink to &quot;Roadmap. Todo. Troubleshooting&quot;">​</a></h2><ul><li>???</li></ul>',48),i=[r];function n(l,c,d,h,p,u){return a(),t("div",null,i)}const b=e(s,[["render",n]]);export{g as __pageData,b as default};
