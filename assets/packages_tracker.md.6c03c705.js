import{_ as e,o as a,c as t,V as s}from"./chunks/framework.c495fe11.js";const u=JSON.parse('{"title":"Tracker","description":"","frontmatter":{},"headers":[],"relativePath":"packages/tracker.md","filePath":"packages/tracker.md"}'),l={name:"packages/tracker.md"},r=s(`<h1 id="tracker" tabindex="-1">Tracker <a class="header-anchor" href="#tracker" aria-label="Permalink to &quot;Tracker&quot;">​</a></h1><p><a href="https://escolalms.github.io/Tracker/" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/documentation-swagger-green" alt="swagger"></a><a href="https://codecov.io/gh/EscolaLMS/Tracker" target="_blank" rel="noreferrer"><img src="https://codecov.io/gh/EscolaLMS/Tracker/branch/main/graph/badge.svg?token=NRAN4R8AGZ" alt="codecov"></a><a href="https://github.com/EscolaLMS/Tracker/actions/workflows/test.yml" target="_blank" rel="noreferrer"><img src="https://github.com/EscolaLMS/Tracker/actions/workflows/test.yml/badge.svg" alt="phpunit"></a><a href="https://packagist.org/packages/escolalms/tracker" target="_blank" rel="noreferrer"><img src="https://img.shields.io/packagist/dt/escolalms/tracker" alt="downloads"></a><a href="https://packagist.org/packages/escolalms/tracker" target="_blank" rel="noreferrer"><img src="https://img.shields.io/packagist/v/escolalms/tracker" alt="downloads"></a><a href="https://packagist.org/packages/escolalms/tracker" target="_blank" rel="noreferrer"><img src="https://img.shields.io/packagist/l/escolalms/tracker" alt="downloads"></a></p><h2 id="what-does-it-do" tabindex="-1">What does it do <a class="header-anchor" href="#what-does-it-do" aria-label="Permalink to &quot;What does it do&quot;">​</a></h2><p>The package is used to track the api route. Tracker is enabled by default and track routes with <code>/api/admin</code> prefix. By default, <code>/api/admin/tracks/routes</code> is ignored.</p><h2 id="installing" tabindex="-1">Installing <a class="header-anchor" href="#installing" aria-label="Permalink to &quot;Installing&quot;">​</a></h2><ul><li><code>composer require escolalms/tracker</code></li><li><code>php artisan migrate</code></li><li><code>php artisan db:seed --class=&quot;EscolaLms\\Tracker\\Database\\Seeders\\TrackerPermissionSeeder&quot;</code></li></ul><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h2><p>You can configure this package by specifying keys in the .env file.</p><ul><li><code>TRACKER_ENABLED</code> - enable or disable route tracking</li><li><code>TRACKER_ROUTE_PREFIX</code> - set tracked route prefix</li><li><code>TRACKER_CONNECTION</code> - database connection, by default <code>sqlite</code></li></ul><p>You can also use <a href="https://github.com/EscolaLMS/Tracker/tree/main/src/Facades/Tracker.php" target="_blank" rel="noreferrer">facade</a> to configure tracker.</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Tracker</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">disable</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#FFCB6B;">Http</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">api/admin/example-route</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">Tracker</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">enable</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">Tracker</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">ignoreUris</span><span style="color:#89DDFF;">([</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">api/admin/example-route</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#FFCB6B;">Http</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">api/admin/example-route</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">Tracker</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">prefix</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">api</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#FFCB6B;">Http</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">api/example-route</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><h2 id="database" tabindex="-1">Database <a class="header-anchor" href="#database" aria-label="Permalink to &quot;Database&quot;">​</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">TrackRoutes - stores tracked routes</span></span></code></pre></div><p>Table <code>track_routes</code> sample rows</p><table><thead><tr><th style="text-align:left;">id</th><th style="text-align:left;">user_id</th><th style="text-align:left;">path</th><th style="text-align:left;">full_path</th><th style="text-align:left;">method</th><th style="text-align:left;">extra</th><th style="text-align:left;">created_at</th><th style="text-align:left;">updated_at</th></tr></thead><tbody><tr><td style="text-align:left;">1</td><td style="text-align:left;">2</td><td style="text-align:left;">/api/admin/example-1</td><td style="text-align:left;">/api/admin/example-1?key=value</td><td style="text-align:left;">GET</td><td style="text-align:left;">NULL</td><td style="text-align:left;">2022-04-14 08:49:25</td><td style="text-align:left;">2022-04-14 08:49:25</td></tr><tr><td style="text-align:left;">2</td><td style="text-align:left;">33</td><td style="text-align:left;">/api/admin/example-2</td><td style="text-align:left;">/api/admin/example-2</td><td style="text-align:left;">POST</td><td style="text-align:left;">NULL</td><td style="text-align:left;">2022-04-14 08:49:25</td><td style="text-align:left;">2022-04-14 08:49:25</td></tr></tbody></table><h2 id="endpoints" tabindex="-1">Endpoints <a class="header-anchor" href="#endpoints" aria-label="Permalink to &quot;Endpoints&quot;">​</a></h2><p><a href="https://escolalms.github.io/Tracker/" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/documentation-swagger-green" alt="swagger"></a></p><h2 id="tests" tabindex="-1">Tests <a class="header-anchor" href="#tests" aria-label="Permalink to &quot;Tests&quot;">​</a></h2><p>Run <code>./vendor/bin/phpunit</code> to run tests. See <a href="https://github.com/EscolaLMS/Tracker/tree/main/tests" target="_blank" rel="noreferrer">tests</a> folder as it&#39;s quite good staring point as documentation appendix.</p><p><a href="https://codecov.io/gh/EscolaLMS/Tracker" target="_blank" rel="noreferrer"><img src="https://codecov.io/gh/EscolaLMS/Tracker/branch/main/graph/badge.svg?token=NRAN4R8AGZ" alt="codecov"></a><a href="https://github.com/EscolaLMS/Tracker/actions/workflows/test.yml" target="_blank" rel="noreferrer"><img src="https://github.com/EscolaLMS/Tracker/actions/workflows/test.yml/badge.svg" alt="phpunit"></a></p><h2 id="permissions" tabindex="-1">Permissions <a class="header-anchor" href="#permissions" aria-label="Permalink to &quot;Permissions&quot;">​</a></h2><p>Permissions are defined in <a href="https://github.com/EscolaLMS/Tracker/tree/main/database/seeders/TrackerPermissionSeeder.php" target="_blank" rel="noreferrer">seeder</a></p><h2 id="problems" tabindex="-1">Problems <a class="header-anchor" href="#problems" aria-label="Permalink to &quot;Problems&quot;">​</a></h2><ul><li><p>No permission to write to the database:</p><p>If you encounter such an error you need to check the permissions of the <code>database.sqlite</code> file on the server. If the file is not given write permissions, SQL will throw an error about not being able to write. The file should have at least 0666 permissions.</p></li><li><p>track_routes table not found:</p><p>The error occurs because the migrations that create the tables have not been run. There is only an empty database file. You should run the <code>php artisan oprimize:clear</code> or <code>php artisan cache:clear</code> command. SqliteServiceProvider will check from the values in the cache whether migrations have been run and if the table does not exist it will create it in the database.</p></li></ul>`,24),o=[r];function n(i,c,p,d,h,g){return a(),t("div",null,o)}const y=e(l,[["render",n]]);export{u as __pageData,y as default};
